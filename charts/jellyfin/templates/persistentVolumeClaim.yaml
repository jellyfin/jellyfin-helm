{{- range $volume := list "media" "config" "cache" }}
{{- with $value := index $.Values.persistence $volume }}
{{- if eq $value.enabled true }}
---
kind: PersistentVolumeClaim
apiVersion: v1
metadata:
  name: {{ include "jellyfin.fullname" $ }}-{{ $volume }}
  namespace: {{ $.Release.Namespace }}
  labels:
    {{- include "jellyfin.labels" $ | nindent 4 }}
spec:
  accessModes:
    - {{ $value.accessMode | quote }}
  resources:
    requests:
      storage: {{ $value.size | quote }}
  {{- with $value.storageClass }}
  storageClassName: {{ . }}
  {{- end }}
{{- end }}
{{- end }}
{{- end }}
